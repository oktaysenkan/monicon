---
title: Custom Plugin
description: Build your own Monicon plugins with full control over icon processing
---

Learn how to create custom Monicon plugins to extend functionality with your own icon processing logic, custom file generation, and lifecycle hooks.

## Plugin Structure

A Monicon plugin is a function that returns another function, which receives the icon payload and returns a plugin instance with lifecycle hooks.

```ts twoslash title="my-plugin.ts"
import type {
  MoniconPlugin,
  MoniconPluginFile,
  MoniconPluginGenerateContext,
} from "@monicon/core/plugins";

type MyPluginOptions = {
  outputPath?: string;
  customOption?: string;
};

export const myPlugin: MoniconPlugin<MyPluginOptions> =
  (options) => (payload) => {
    return {
      name: "my-custom-plugin",
      generate(context: MoniconPluginGenerateContext) {
        const files: MoniconPluginFile[] = [];

        for (const icon of payload.icons) {
          files.push({
            path: `${options?.outputPath ?? "output"}/${icon.name}.svg`,
            content: icon.svg,
          });
        }

        return files;
      },
    };
  };
```

## Plugin Types

Monicon provides TypeScript types to help you build type-safe plugins.

### `MoniconPlugin<T>`

The main plugin type that defines the plugin factory function signature.

```ts twoslash
import type { MoniconPlugin } from "@monicon/core/plugins";

type Options = { prefix?: string };

const plugin: MoniconPlugin<Options> = (options) => (payload) => ({
  name: "example-plugin",
  generate: () => [],
});
```

### `MoniconPluginFile`

Represents a file to be generated by the plugin.

```ts twoslash
import type { MoniconPluginFile } from "@monicon/core/plugins";

const file: MoniconPluginFile = {
  path: "output/icon.svg",
  content: "<svg>...</svg>",
};
```

### `MoniconPluginPayload`

The payload passed to the plugin containing the icons to process.

```ts twoslash
import type { Icon } from "@monicon/core";

type MoniconPluginPayload = {
  icons: Icon[];
};
```

### `Icon`

The icon object containing all icon data.

```ts twoslash
type Icon = {
  name: string;
  svg: string;
  width: number;
  height: number;
};
```

## Lifecycle Hooks

Plugins can implement lifecycle hooks to execute code at different stages of the generation process.

### `generate`

**Required.** The main generation function that returns an array of files to create.

```ts twoslash
import type {
  MoniconPlugin,
  MoniconPluginGenerateContext,
} from "@monicon/core/plugins";

const plugin: MoniconPlugin = () => (payload) => ({
  name: "my-plugin",
  generate(context: MoniconPluginGenerateContext) {
    console.log("Generating files for", payload.icons.length, "icons");
    console.log("Config file path:", context.configFilePath);

    return payload.icons.map((icon) => ({
      path: `output/${icon.name}.svg`,
      content: icon.svg,
    }));
  },
});
```

### `onPluginsLoad`

Called when all plugins are loaded. Useful for plugin initialization or validation.

```ts twoslash
import type {
  MoniconPlugin,
  MoniconPluginLoadContext,
} from "@monicon/core/plugins";

const plugin: MoniconPlugin = () => (payload) => ({
  name: "my-plugin",
  generate: () => [],
  onPluginsLoad(context: MoniconPluginLoadContext) {
    console.log("Loaded plugins:", context.plugins);
  },
});
```

### `beforeGenerate`

Called before the `generate` function runs.

```ts twoslash
import type {
  MoniconPlugin,
  MoniconPluginGenerateContext,
} from "@monicon/core/plugins";

const plugin: MoniconPlugin = () => (payload) => ({
  name: "my-plugin",
  generate: () => [],
  beforeGenerate(context: MoniconPluginGenerateContext) {
    console.log("About to generate", context.icons.length, "icons");
  },
});
```

### `afterGenerate`

Called after the `generate` function completes.

```ts twoslash
import type {
  MoniconPlugin,
  MoniconPluginGenerateContext,
} from "@monicon/core/plugins";

const plugin: MoniconPlugin = () => (payload) => ({
  name: "my-plugin",
  generate: () => [],
  afterGenerate(context: MoniconPluginGenerateContext) {
    console.log("Finished generating icons");
  },
});
```

### `beforeWriteFiles`

Called before files are written to disk.

```ts twoslash
import type {
  MoniconPlugin,
  MoniconPluginWriteFilesContext,
} from "@monicon/core/plugins";

const plugin: MoniconPlugin = () => (payload) => ({
  name: "my-plugin",
  generate: () => [],
  beforeWriteFiles(context: MoniconPluginWriteFilesContext) {
    console.log("About to write", context.files.length, "files");
  },
});
```

### `afterWriteFiles`

Called after files have been written to disk.

```ts twoslash
import type {
  MoniconPlugin,
  MoniconPluginWriteFilesContext,
} from "@monicon/core/plugins";

const plugin: MoniconPlugin = () => (payload) => ({
  name: "my-plugin",
  generate: () => [],
  afterWriteFiles(context: MoniconPluginWriteFilesContext) {
    console.log("Successfully wrote", context.files.length, "files");
  },
});
```

## Context Objects

Each lifecycle hook receives a context object with relevant information.

### `MoniconPluginGenerateContext`

Available in `generate`, `beforeGenerate`, and `afterGenerate` hooks.

- **`icons`** - Array of icons being processed
- **`configUpdated`** - Whether the config file was updated
- **`configFilePath`** - Path to the Monicon config file

### `MoniconPluginLoadContext`

Available in `onPluginsLoad` hook.

- **`plugins`** - Array of loaded plugin names
- **`configUpdated`** - Whether the config file was updated
- **`configFilePath`** - Path to the Monicon config file

### `MoniconPluginWriteFilesContext`

Available in `beforeWriteFiles` and `afterWriteFiles` hooks.

- **`files`** - Array of files to be written or that were written
- **`configUpdated`** - Whether the config file was updated
- **`configFilePath`** - Path to the Monicon config file

## Examples

### TypeScript Definition Generator

Generate TypeScript type definitions for your icons:

```ts twoslash title="typescript-defs-plugin.ts"
import type { MoniconPlugin, MoniconPluginFile } from "@monicon/core/plugins";

type TypescriptDefsOptions = {
  outputPath?: string;
};

export const typescriptDefs: MoniconPlugin<TypescriptDefsOptions> =
  (options) => (payload) => ({
    name: "typescript-defs-plugin",
    generate() {
      const iconNames = payload.icons
        .map((icon) => `"${icon.name}"`)
        .join(" | ");

      const content = `// Auto-generated by Monicon
export type IconName = ${iconNames};

export const iconNames = [
${payload.icons.map((icon) => `  "${icon.name}",`).join("\n")}
] as const;
`;

      return [
        {
          path: `${options?.outputPath ?? "src/types"}/icons.d.ts`,
          content,
        },
      ];
    },
  });
```

### Icon Statistics Logger

Log statistics about processed icons:

```ts twoslash title="stats-plugin.ts"
import type { MoniconPlugin } from "@monicon/core/plugins";

export const stats: MoniconPlugin = () => (payload) => ({
  name: "stats-plugin",
  generate: () => [],
  beforeGenerate() {
    console.log(`\nðŸ“Š Icon Statistics:`);
    console.log(`   Total icons: ${payload.icons.length}`);

    const collections = new Map<string, number>();
    for (const icon of payload.icons) {
      const [collection] = icon.name.split(":");
      collections.set(collection, (collections.get(collection) ?? 0) + 1);
    }

    console.log(`   Collections:`);
    for (const [name, count] of collections) {
      console.log(`     - ${name}: ${count} icons`);
    }
  },
  afterWriteFiles(context) {
    console.log(`\nâœ… Generated ${context.files.length} files`);
  },
});
```

## Using with Generic Plugin

For simpler use cases, you can extend the [Generic plugin](/docs/plugins/generic) instead of building from scratch:

```ts twoslash title="extended-generic-plugin.ts"
import {
  generic,
  GenericPluginOptions,
  MoniconPlugin,
} from "@monicon/core/plugins";

type MyOptions = GenericPluginOptions<{
  foo?: string;
}>;

export const myPlugin: MoniconPlugin<MyOptions> = (options) =>
  generic({
    name: "my-extended-plugin",
    outputPath: options?.outputPath ?? "output",
    extension: "json",
    content: (icon) => {
      return JSON.stringify(
        {
          name: icon.name,
          svg: icon.svg,
          foo: options?.foo,
        },
        null,
        2
      );
    },
  });
```
